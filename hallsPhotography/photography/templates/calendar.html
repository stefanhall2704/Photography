<html>
{% include "navbar.html" %}

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.3.1/mdb.min.js"></script>
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital@1&display=swap" rel="stylesheet" />

  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <style>
    .lora-font {
      font-family: "Lora", serif;
    }
  </style>
  <!-- MDB -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.3.1/mdb.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
    integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
    integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
    crossorigin="anonymous"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital@1&display=swap" rel="stylesheet" />
  <style>
    /* Center the calendar within its container */
    table {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 30%;
      background-color: #fff;
      /* White background */
    }

    < !-- #pagination {
      -->< !-- display: flex;
      -->< !-- align-items: center;
      -->< !-- height: 100vh;
      -->< !--
    }

    -->

    /* Calendar styling */
    .month {
      font-family: "Arial", sans-serif;
      color: #000;
      text-align: center;
      font-size: 24px;
      background: gray;
      padding: 10px 0;
      heigh: 50px;
    }

    .mon,
    .tue,
    .wed,
    .thu,
    .fri {
      font-family: "Arial", sans-serif;
      font-weight: bold;
      text-align: center;
      width: 30px;
      height: 30px;
      background: #fb8b24;
      color: #fff;
      border: 1px solid #ccc;
      padding: 10px;
    }

    .sat,
    .sun {
      font-family: "Arial", sans-serif;
      font-weight: bold;
      text-align: center;
      width: 30px;
      height: 30px;
      background-color: #9a031e;
      /* Weekend background color */
      color: #fff;
      border: 1px solid #ccc;
      padding: 10px;
    }

    .noday {
      font-family: "Arial", sans-serif;
      font-weight: bold;
      text-align: center;
      width: 30px;
      height: 30px;
      background: #fb8b24;
      color: #fff;
      border: 1px solid #ccc;
      padding: 10px;
    }

    #previous {
      background-color: #9a031e;
    }

    #next_button {
      background-color: #9a031e;
    }

    .highlight-day {
      background-color: yellow;
      /* Change the background color as an example */
      /* Add more CSS rules as needed */
    }

    .pagination {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background-color: gray;
      height: 100%;
    }

    .pagination_buttons {
      margin-bottom: 7%;
    }
  </style>




<!-- Example script to update the calendar -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Get the events from the hidden input element
    const eventsInput = document.getElementById("events");
    const eventsString = eventsInput.value;

    console.log("Events String:", eventsString); // Log the events string to the console

    try {
      // Replace 'True' with 'true' and 'False' with 'false'
      const correctedEventsString = eventsString.replace(/True/g, 'true').replace(/False/g, 'false');

      // Use eval() to parse the string as JavaScript object
      const events = eval('(' + correctedEventsString + ')');

      // Create a dialog element
      const dialog = document.createElement("dialog");
      document.body.appendChild(dialog);

      // Create an object to store the count of events per day
      const eventCountPerDay = {};

      // Loop through each event and update the eventCountPerDay object
      events.forEach(function (event) {
        const eventDate = new Date(event.start.date).getDate();
        if (eventCountPerDay[eventDate]) {
          eventCountPerDay[eventDate]++;
        } else {
          eventCountPerDay[eventDate] = 1;
        }
      });

      // Loop through each day in the calendar
      const tableDataElements = document.querySelectorAll("table td");
      tableDataElements.forEach(function (td) {
        const day = parseInt(td.textContent.trim());

        // Check if events exist for the current day
        if (eventCountPerDay[day]) {
          // Check if multiple events exist for the current day
          if (eventCountPerDay[day] > 1) {
            td.style.backgroundColor = "#ccc"; // Change background color to gray
          } else {
            td.style.backgroundColor = "#3498db"; // Change background color for a single event
            td.style.cursor = "pointer"; // Change cursor to indicate it's clickable

            // Add an event listener to open the dialog on click
            td.addEventListener("click", function () {
              // Clear previous content
              while (dialog.firstChild) {
                dialog.removeChild(dialog.firstChild);
              }

              // Create a title for the dialog
              const title = document.createElement("h2");
              title.textContent = `Events for Day ${day}`;
              dialog.appendChild(title);

              // Create an unordered list to display events
              const eventsList = document.createElement("ul");

              // Loop through events for the current day and add them to the list
              events.forEach(function (event) {
                const eventDate = new Date(event.start.date).getDate();
                if (eventDate === day) {
                  const listItem = document.createElement("li");
                  listItem.textContent = event.summary;
                  eventsList.appendChild(listItem);
                }
              });

              // Add the events list to the dialog
              dialog.appendChild(eventsList);

              // Create a close button
              const closeButton = document.createElement("button");
              closeButton.textContent = "Close";
              closeButton.addEventListener("click", function () {
                // Close the dialog
                dialog.close();
              });

              // Add the close button to the dialog
              dialog.appendChild(closeButton);

              // Show the dialog
              dialog.showModal();
            });
          }
        } else {
          // If no events for the current day, set the cursor to default
          td.style.cursor = "default";
        }
      });
    } catch (error) {
      console.error("Error parsing JSON:", error);
    }
  });
</script>



  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Get the day value from the hidden input element
      const day = document.getElementById("day").value;

      if (day != 0) {
        // Find all table data (td) elements in the table
        const tableDataElements = document.querySelectorAll("table td");

        // Loop through the table data elements and compare their text content to the day value
        tableDataElements.forEach(function (td) {
          if (td.textContent.trim() === day) {
            // Add CSS styles to change the appearance of the matching table cell
            td.style.backgroundColor = "#e36414"; // Change background color as an example
            // You can apply other CSS styles as needed
          }
        });
      }
    });
  </script>

  <script>
    function changeMonth(offset) {
      var currentMonth = parseInt($("#month").val());
      var currentYear = parseInt($("#year").val());

      // Calculate the new month and year
      var newMonth = currentMonth + offset;
      var newYear = currentYear;

      if (newMonth > 12) {
        newMonth = 1;
        newYear++;
      } else if (newMonth < 1) {
        newMonth = 12;
        newYear--;
      }

      // Update the hidden input fields
      $("#month").val(newMonth);
      $("#year").val(newYear);

      // Reload the page with the new URL
      window.location.href = `/schedule/${newYear}/${newMonth}`;
    }
  </script>
</head>
<input id="day" type="hidden" value="{{day}}" />
<input id="month" type="hidden" value="{{month}}" />
<input id="year" type="hidden" value="{{year}}" />
<input id="events" type="hidden" value="{{events}}" />
<div class="pagination">
  <div class="pagination_buttons">
    <button id="previous" onclick="changeMonth(-1)">Previous Month</button>
    <button id="next_button" onclick="changeMonth(1)">Next Month</button>
  </div>
  <div class="calendar-container">{{calendar|safe}}</div>
</div>

</html>
